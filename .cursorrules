# Araponga - Cursor Best Practices

**Vers√£o**: 1.5  
**Data**: 2025-01-20  
**Projeto**: Araponga - Plataforma Digital Comunit√°ria Orientada ao Territ√≥rio

---

## üìö Arquivos de Refer√™ncia para Contexto

### Design e Identidade Visual
- `docs/DESIGN_SYSTEM_IDENTIDADE_VISUAL.md` - Identidade visual completa, cores, tipografia, componentes
- `docs/CURSOR_DESIGN_RULES.md` - Regras pr√°ticas de design (mobile-first obrigat√≥rio, vari√°veis CSS, escala 8px)
- `docs/ANALISE_DESIGN_SISTEMATICA_MELHORIAS.md` - An√°lise detalhada e propostas de melhoria
- `docs/REVISAO_ARTE_DESIGN_WIKI.md` - Revis√£o completa de conformidade (2025-01-20) - li√ß√µes aprendidas sobre cores hardcoded

### Processo de Melhoria Cont√≠nua
- `docs/PROCESSO_AUTO_APRENDIZADO_REVISOES.md` - ‚ö†Ô∏è OBRIGAT√ìRIO: Processo sistem√°tico de captura e aplica√ß√£o de li√ß√µes aprendidas ap√≥s revis√µes
- `docs/LICOES_APRENDIDAS.md` - Registro de li√ß√µes aprendidas de revis√µes t√©cnicas, categorizadas por prioridade

### Regras e Padr√µes
- `docs/CURSOR_DOCUMENTATION_RULES.md` - ‚ö†Ô∏è OBRIGAT√ìRIO: Mapeamento de mudan√ßas ‚Üí documentos, checklist de documenta√ß√£o
- `docs/10_ARCHITECTURE_DECISIONS.md` - Decis√µes arquiteturais (ADRs), padr√µes estabelecidos
- `docs/11_ARCHITECTURE_SERVICES.md` - Estrutura e organiza√ß√£o de services
- `docs/12_DOMAIN_MODEL.md` - Modelo de dom√≠nio, entidades e relacionamentos
- `docs/05_GLOSSARY.md` - Terminologia correta: territory (n√£o "place"), items (n√£o "listings"), 29 fases

### Vis√£o e Neg√≥cio
- `docs/01_PRODUCT_VISION.md` - Vis√£o do produto, princ√≠pios, valores
- `docs/60_API_L√ìGICA_NEG√ìCIO.md` - L√≥gica de neg√≥cio completa, contratos de API, casos de uso

### Padr√µes de C√≥digo e Testes
- `docs/21_CODE_REVIEW.md` - Padr√µes de c√≥digo, an√°lise de gaps
- `docs/22_COHESION_AND_TESTS.md` - Cobertura de testes (>90%), estrutura de testes
- `docs/41_CONTRIBUTING.md` - Padr√µes de contribui√ß√£o

### Configura√ß√µes T√©cnicas
- `frontend/wiki/app/globals.css` - Design tokens CSS (cores, espa√ßamento, tipografia)
- `frontend/wiki/tailwind.config.ts` - Configura√ß√£o Tailwind CSS
- `global.json` - Vers√£o .NET configurada
- `backend/Araponga.Api/Program.cs` - Configura√ß√£o da aplica√ß√£o, DI, middlewares
- `.editorconfig` - Configura√ß√£o de formata√ß√£o (indent C# 4, TS/JS 2)

---

## üéØ Princ√≠pios Fundamentais do Projeto

### Territ√≥rio como Refer√™ncia
- **Territory** √© geogr√°fico e neutro - representa apenas um lugar f√≠sico real
- Territ√≥rio existe antes do app e continua existindo sem usu√°rios
- L√≥gica social (memberships, visibilidade, modera√ß√£o) fica em camadas separadas
- **NUNCA** coloque l√≥gica social dentro da entidade Territory

### Nomenclatura Obrigat√≥ria
- ‚úÖ Use sempre **territory** (NUNCA "place" ou "location")
- ‚úÖ Use **items** (NUNCA "listings") para produtos do marketplace
- ‚úÖ Use **29 fases** (NUNCA "24 fases") ao referenciar backlog
- ‚úÖ Use **membership** para v√≠nculo usu√°rio-territ√≥rio
- ‚úÖ Use **visitor/resident** para pap√©is (NUNCA "user", "member" gen√©rico)

### Valores do Projeto
- Autonomia local
- Cuidado coletivo
- Continuidade da vida no territ√≥rio
- Fortalecimento do v√≠nculo entre pessoas e lugar
- **N√ÉO √©**: marketplace agressivo, rede de engajamento infinito, produto de vigil√¢ncia

---

## üèóÔ∏è Arquitetura e Estrutura

### Clean Architecture - Separa√ß√£o de Camadas

```
backend/
‚îú‚îÄ‚îÄ Araponga.Api          # API HTTP (controllers, endpoints, middlewares)
‚îú‚îÄ‚îÄ Araponga.Application  # Casos de uso / regras de aplica√ß√£o
‚îú‚îÄ‚îÄ Araponga.Domain       # Modelo de dom√≠nio (territory, regras centrais)
‚îú‚îÄ‚îÄ Araponga.Infrastructure # Persist√™ncia, integra√ß√µes, adapters
‚îú‚îÄ‚îÄ Araponga.Shared       # Tipos e utilit√°rios compartilhados
‚îî‚îÄ‚îÄ Araponga.Tests        # Testes automatizados
```

### Regras de Depend√™ncia
- ‚úÖ **Domain** n√£o depende de NADA (camada mais interna)
- ‚úÖ **Application** depende apenas de **Domain**
- ‚úÖ **Infrastructure** depende de **Domain** e **Application**
- ‚úÖ **Api** depende de todas as outras (camada mais externa)
- ‚ùå **NUNCA** importe Infrastructure ou Api em Domain ou Application

### Organiza√ß√£o de C√≥digo

#### Domain Layer
- Entidades de dom√≠nio (ex: `Territory`, `Membership`, `Post`)
- Value Objects (ex: `GeoAnchor`, `Address`)
- Interfaces de reposit√≥rios (ex: `ITerritoryRepository`)
- Exce√ß√µes de dom√≠nio (ex: `TerritoryNotFoundException`)
- **N√ÉO** coloque l√≥gica de persist√™ncia aqui

#### Application Layer
- Services (ex: `TerritoryService`, `PostCreationService`)
- DTOs de aplica√ß√£o (ex: `CreatePostRequest`, `PostResponse`)
- Interfaces de servi√ßos externos (ex: `IMediaStorageService`)
- **N√ÉO** coloque l√≥gica HTTP aqui

#### Infrastructure Layer
- Implementa√ß√µes de reposit√≥rios (ex: `PostgresTerritoryRepository`)
- Implementa√ß√µes de servi√ßos externos (ex: `S3MediaStorageService`)
- Configura√ß√µes (ex: `DbContext`, `ServiceCollectionExtensions`)
- **N√ÉO** coloque l√≥gica de neg√≥cio aqui

#### Api Layer
- Controllers (ex: `TerritoriesController`, `FeedController`)
- Middlewares (ex: `AuthenticationMiddleware`, `ErrorHandlingMiddleware`)
- Configura√ß√µes de API (ex: `Program.cs`, `Startup.cs`)
- **N√ÉO** coloque l√≥gica de neg√≥cio aqui

---

## üìù Padr√µes de C√≥digo

### ‚ö†Ô∏è OBRIGAT√ìRIO: Princ√≠pios SOLID e YAGNI/KISS

**TODO c√≥digo DEVE seguir os princ√≠pios SOLID, YAGNI e KISS por padr√£o.**

#### SOLID - Princ√≠pios de Design Orientado a Objetos

**S - Single Responsibility Principle (SRP)**
- ‚úÖ Cada fun√ß√£o/classe/m√≥dulo deve ter UMA √∫nica responsabilidade
- ‚úÖ Se uma fun√ß√£o faz mais de uma coisa, quebre em fun√ß√µes menores
- ‚ùå Evite "God Objects" ou fun√ß√µes monol√≠ticas que fazem tudo

**O - Open/Closed Principle (OCP)**
- ‚úÖ Aberto para extens√£o, fechado para modifica√ß√£o
- ‚úÖ Use interfaces e abstra√ß√µes para permitir extens√£o sem modificar c√≥digo existente
- ‚úÖ Prefira composi√ß√£o e estrat√©gias em vez de if/switch gigantes

**L - Liskov Substitution Principle (LSP)**
- ‚úÖ Subtipos devem ser substitu√≠veis por seus tipos base sem quebrar o c√≥digo
- ‚úÖ Implementa√ß√µes de interfaces devem cumprir contratos esperados

**I - Interface Segregation Principle (ISP)**
- ‚úÖ Interfaces espec√≠ficas e pequenas s√£o melhores que uma interface gen√©rica grande
- ‚úÖ Clientes n√£o devem depender de m√©todos que n√£o usam
- ‚úÖ Prefira m√∫ltiplas interfaces pequenas a uma interface monol√≠tica

**D - Dependency Inversion Principle (DIP)**
- ‚úÖ Dependa de abstra√ß√µes (interfaces), n√£o de implementa√ß√µes concretas
- ‚úÖ Use Dependency Injection (DI) para injetar depend√™ncias
- ‚úÖ Alto n√≠vel n√£o deve depender de baixo n√≠vel; ambos devem depender de abstra√ß√µes

#### YAGNI - You Aren't Gonna Need It

- ‚úÖ **N√ÉO** adicione funcionalidades "por precau√ß√£o" ou "pode ser √∫til no futuro"
- ‚úÖ Implemente apenas o que √© necess√°rio AGORA para o requisito atual
- ‚úÖ Refatore quando a necessidade surgir, n√£o antes
- ‚ùå Evite abstra√ß√µes excessivas "para preparar para o futuro"

#### KISS - Keep It Simple, Stupid

- ‚úÖ **Simplicidade acima de complexidade**
- ‚úÖ Prefira solu√ß√µes simples e diretas sobre solu√ß√µes "elegantes" complexas
- ‚úÖ C√≥digo leg√≠vel e f√°cil de entender √© melhor que c√≥digo "inteligente" dif√≠cil
- ‚úÖ Se algo parece complicado, provavelmente h√° uma forma mais simples

#### Exemplos de Aplica√ß√£o

**‚ùå BAD - Viola SRP, KISS e YAGNI:**
```typescript
// Uma fun√ß√£o faz tudo: processa markdown, gera IDs, processa links, remove H1
function processEverything(content: string, basePath: string, removeH1: boolean, generateIds: boolean): ProcessedContent {
  // ... 200 linhas fazendo tudo ...
}
```

**‚úÖ GOOD - Segue SOLID, YAGNI e KISS:**
```typescript
// Fun√ß√µes pequenas com responsabilidade √∫nica
export function getTextContent(html: string): string { ... }
export function generateUniqueId(text: string, usedIds: Map<string, number>): string { ... }
export function processMarkdownLinks(html: string, basePath: string): string { ... }
export function extractFirstH1(htmlContent: string): { title: string | null; content: string } { ... }

// Composi√ß√£o: usa fun√ß√µes pequenas para criar funcionalidade maior
export async function processMarkdownContent(filePath: string, basePath: string): Promise<DocumentContent | null> {
  const htmlContent = await parseMarkdown(content);
  const { title, content } = extractFirstH1(htmlContent);
  const withIds = addHeadingIds(content);
  const withLinks = processMarkdownLinks(withIds, basePath);
  return { content: withLinks, title, frontMatter: data };
}
```

#### Checklist Antes de Escrever C√≥digo

- [ ] Esta fun√ß√£o/classe tem apenas UMA responsabilidade?
- [ ] Estou adicionando funcionalidade que n√£o √© necess√°ria agora? (YAGNI)
- [ ] Existe uma forma mais simples de fazer isso? (KISS)
- [ ] Estou dependendo de abstra√ß√µes ou implementa√ß√µes concretas? (DIP)
- [ ] Esta interface/abstra√ß√£o √© realmente necess√°ria agora ou √© "prepara√ß√£o para o futuro"? (YAGNI)
- [ ] O c√≥digo ficou mais leg√≠vel e f√°cil de entender?

### ‚ö†Ô∏è OBRIGAT√ìRIO: Clean Code (Uncle Bob)

**TODO c√≥digo DEVE seguir os princ√≠pios de Clean Code de Robert C. Martin (Uncle Bob).**

#### Nomes Significativos

**Use nomes que revelem inten√ß√£o:**
- ‚úÖ `daysSinceCreation` em vez de `d`
- ‚úÖ `isValidUser` em vez de `flag`
- ‚úÖ `calculateTotalPrice()` em vez de `calc()`
- ‚úÖ `userRepository` em vez de `repo`
- ‚ùå Evite abrevia√ß√µes desnecess√°rias
- ‚ùå Evite nomes gen√©ricos (`data`, `info`, `temp`, `var`)

**Use nomes pronunci√°veis e pesquis√°veis:**
- ‚úÖ `numberOfDays` em vez de `n`
- ‚úÖ `MAX_RETRY_COUNT` em vez de `42`
- ‚ùå Evite nomes de uma letra (exceto em loops curtos: `i`, `j`, `k`)

**Use vocabul√°rio consistente:**
- ‚úÖ Use sempre o mesmo termo para o mesmo conceito
- ‚úÖ Se √© `fetch`, use sempre `fetch` (n√£o misture com `get`, `retrieve`, `load`)
- ‚úÖ Se √© `user`, use sempre `user` (n√£o misture com `account`, `client`)

**Evite informa√ß√µes enganosas:**
- ‚ùå N√£o use `accountList` se n√£o for uma lista (use `accounts` ou `accountGroup`)
- ‚ùå N√£o use `o` (letra O) ou `l` (letra L) como nomes de vari√°veis
- ‚ùå N√£o use nomes que diferem apenas por um caractere (`user` vs `users`)

#### Fun√ß√µes

**Pequenas! Pequenas! Pequenas!**
- ‚úÖ Fun√ß√µes devem fazer UMA coisa. Devem faz√™-la bem. Devem ser a √∫nica coisa que fazem.
- ‚úÖ **M√°ximo 20 linhas** (ideal: menos de 10)
- ‚úÖ Se uma fun√ß√£o tem mais de 20 linhas, quebre em fun√ß√µes menores
- ‚ùå Evite fun√ß√µes com mais de 50 linhas

**Um n√≠vel de abstra√ß√£o por fun√ß√£o:**
- ‚úÖ Todas as declara√ß√µes na fun√ß√£o devem estar no mesmo n√≠vel de abstra√ß√£o
- ‚úÖ Se voc√™ tem `getUser()`, `validateUser()`, `saveUser()` na mesma fun√ß√£o, est√° misturando n√≠veis

**Nomes descritivos:**
- ‚úÖ O nome da fun√ß√£o deve dizer o que ela faz
- ‚úÖ `calculateTotalPrice()` √© melhor que `process()`
- ‚úÖ `isValidEmail()` √© melhor que `check()`

**Argumentos:**
- ‚úÖ **Zero argumentos** √© o ideal (fun√ß√µes sem par√¢metros s√£o mais f√°ceis de testar)
- ‚úÖ **Um argumento** √© bom
- ‚úÖ **Dois argumentos** √© aceit√°vel
- ‚ö†Ô∏è **Tr√™s argumentos** deve ser evitado
- ‚ùå **Mais de tr√™s argumentos** - considere usar um objeto/struct

**Sem efeitos colaterais:**
- ‚úÖ Fun√ß√£o deve fazer apenas o que o nome diz
- ‚ùå N√£o altere vari√°veis globais
- ‚ùå N√£o altere par√¢metros de entrada (a menos que seja explicitamente o prop√≥sito)
- ‚úÖ Se precisa alterar estado, torne isso expl√≠cito no nome: `setUserActive()`, `updateUser()`

**Comandos vs Consultas:**
- ‚úÖ Separe comandos (fazem algo) de consultas (retornam algo)
- ‚úÖ `setAttribute()` (comando) vs `getAttribute()` (consulta)
- ‚ùå N√£o fa√ßa `if (setAttribute("key", "value"))` - isso mistura comando e consulta

**Tratamento de Erros:**
- ‚úÖ Use exce√ß√µes em vez de c√≥digos de retorno
- ‚úÖ Trate erros primeiro (early return)
- ‚úÖ N√£o retorne `null` - use `Option<T>` ou `Result<T>`
- ‚úÖ N√£o passe `null` como argumento

#### Coment√°rios

**Coment√°rios s√£o uma falha:**
- ‚ùå **N√ÉO** use coment√°rios para explicar c√≥digo ruim - **reescreva o c√≥digo**
- ‚úÖ C√≥digo bom √© auto-explicativo
- ‚úÖ "O √∫nico coment√°rio verdadeiramente bom √© aquele que voc√™ encontrou uma forma de n√£o escrever"

**Quando comentar (raramente):**
- ‚úÖ Coment√°rios legais (informa√ß√£o que n√£o pode ser expressa no c√≥digo)
- ‚úÖ Avisos de consequ√™ncias (ex: `// WARNING: Esta fun√ß√£o √© O(n¬≤), use com cuidado`)
- ‚úÖ Inten√ß√£o (ex: `// Ordena por data mais recente primeiro para melhor UX`)
- ‚úÖ Clarifica√ß√£o (quando o c√≥digo n√£o pode ser mais claro)
- ‚úÖ TODO (mas resolva r√°pido)

**Quando N√ÉO comentar:**
- ‚ùå Coment√°rios redundantes: `// Incrementa o contador` antes de `counter++`
- ‚ùå Coment√°rios de ru√≠do: `// Construtor padr√£o`
- ‚ùå Coment√°rios obsoletos (c√≥digo mudou, coment√°rio n√£o)
- ‚ùå Coment√°rios de c√≥digo comentado (delete o c√≥digo, n√£o comente)

#### Formata√ß√£o

**Vertical:**
- ‚úÖ Conceitos relacionados devem estar pr√≥ximos
- ‚úÖ Vari√°veis declaradas pr√≥ximas ao uso
- ‚úÖ Fun√ß√µes dependentes devem estar pr√≥ximas (chamador acima do chamado)
- ‚úÖ Espa√ßamento vertical separa conceitos

**Horizontal:**
- ‚úÖ Use indenta√ß√£o consistente (2 espa√ßos para TS/JS, 4 para C#)
- ‚úÖ Alinhamento horizontal √© desnecess√°rio (n√£o alinhe `=` em m√∫ltiplas linhas)
- ‚úÖ Linhas n√£o devem exceder 100-120 caracteres

#### Objetos e Estruturas de Dados

**Abstra√ß√£o de dados:**
- ‚úÖ Exponha dados abstratos, n√£o estruturas concretas
- ‚úÖ Use getters/setters para controlar acesso
- ‚ùå N√£o exponha campos p√∫blicos diretamente

**Lei de Demeter:**
- ‚úÖ Um objeto deve conhecer apenas seus amigos imediatos
- ‚úÖ `user.getAddress().getCity()` viola a lei
- ‚úÖ `user.getCity()` √© melhor (encapsula a navega√ß√£o)

#### Tratamento de Erros

**Use exce√ß√µes em vez de c√≥digos de retorno:**
- ‚úÖ `throw new NotFoundException()` em vez de retornar `null` ou `-1`
- ‚úÖ Use `Result<T>` pattern quando apropriado

**N√£o retorne null:**
- ‚úÖ Use `Option<T>` ou `Maybe<T>` para valores opcionais
- ‚úÖ Use `Result<T>` para opera√ß√µes que podem falhar
- ‚ùå Evite `return null` em m√©todos p√∫blicos

**N√£o passe null:**
- ‚úÖ Valide entrada e lance exce√ß√£o se `null`
- ‚úÖ Use `ArgumentNullException.ThrowIfNull()` em C#
- ‚úÖ Use TypeScript strict null checks

**Trate erros primeiro:**
- ‚úÖ Early return para casos de erro
- ‚úÖ Reduza aninhamento com guard clauses

#### Testes Limpos

**As tr√™s leis do TDD:**
1. N√£o escreva c√≥digo de produ√ß√£o at√© que tenha escrito um teste que falhe
2. N√£o escreva mais de um teste unit√°rio do que o suficiente para falhar
3. N√£o escreva mais c√≥digo de produ√ß√£o do que o suficiente para passar no teste

**Um conceito por teste:**
- ‚úÖ Cada teste deve verificar UMA coisa
- ‚úÖ Nome do teste deve deixar claro o que est√° sendo testado
- ‚úÖ `GetUserById_WhenUserExists_ReturnsUser()` √© melhor que `TestGetUser()`

**F.I.R.S.T. (Testes devem ser):**
- **Fast** - R√°pidos (executar em milissegundos)
- **Independent** - Independentes (n√£o dependem uns dos outros)
- **Repeatable** - Repet√≠veis (mesmo resultado sempre)
- **Self-Validating** - Auto-validantes (passa ou falha, sem interpreta√ß√£o manual)
- **Timely** - Oportunos (escritos antes do c√≥digo de produ√ß√£o)

#### Classes

**Organiza√ß√£o:**
- ‚úÖ Vari√°veis p√∫blicas primeiro
- ‚úÖ Vari√°veis privadas depois
- ‚úÖ Fun√ß√µes p√∫blicas primeiro
- ‚úÖ Fun√ß√µes privadas depois

**Classes pequenas:**
- ‚úÖ Uma classe deve ter UMA raz√£o para mudar (SRP)
- ‚úÖ **M√°ximo 200 linhas** (ideal: menos de 100)
- ‚úÖ Se uma classe tem mais de 200 linhas, considere quebrar

**Coes√£o:**
- ‚úÖ M√©todos e vari√°veis devem estar relacionados
- ‚úÖ Alta coes√£o: m√©todos usam todas as vari√°veis da classe

#### Organiza√ß√£o

**Pacotes/M√≥dulos:**
- ‚úÖ Organize por funcionalidade, n√£o por camada
- ‚úÖ `user/` cont√©m tudo relacionado a usu√°rio (model, service, repository)
- ‚ùå Evite `models/`, `services/`, `repositories/` separados

**Depend√™ncias:**
- ‚úÖ Depend√™ncias devem apontar na dire√ß√£o da estabilidade
- ‚úÖ Classes est√°veis n√£o devem depender de classes inst√°veis

#### Design Limpo

**Princ√≠pios de design:**
- ‚úÖ Aplicar SOLID em todos os n√≠veis
- ‚úÖ DRY (Don't Repeat Yourself)
- ‚úÖ KISS (Keep It Simple, Stupid)
- ‚úÖ YAGNI (You Aren't Gonna Need It)

**Boy Scout Rule:**
- ‚úÖ Deixe o c√≥digo mais limpo do que voc√™ encontrou
- ‚úÖ Sempre que trabalhar em um arquivo, melhore algo pequeno

#### Exemplos Pr√°ticos

**‚ùå BAD - Viola m√∫ltiplos princ√≠pios:**
```typescript
function p(d: any): any {
  let r = 0;
  for (let i = 0; i < d.length; i++) {
    if (d[i].price) {
      r += d[i].price * d[i].qty;
    }
  }
  return r; // Retorna 0 se vazio, mas deveria retornar null?
}
```

**‚úÖ GOOD - Segue Clean Code:**
```typescript
function calculateTotalPrice(items: CartItem[]): number {
  if (items.length === 0) {
    return 0;
  }
  
  return items.reduce((total, item) => {
    const itemTotal = item.price * item.quantity;
    return total + itemTotal;
  }, 0);
}
```

#### Checklist Clean Code

- [ ] Nomes revelam inten√ß√£o?
- [ ] Fun√ß√µes s√£o pequenas (< 20 linhas)?
- [ ] Fun√ß√µes fazem apenas uma coisa?
- [ ] Argumentos s√£o poucos (< 3)?
- [ ] Sem efeitos colaterais?
- [ ] Comandos separados de consultas?
- [ ] Erros tratados com exce√ß√µes/Result?
- [ ] N√£o retorna null?
- [ ] N√£o passa null?
- [ ] Coment√°rios explicam "por qu√™", n√£o "o qu√™"?
- [ ] C√≥digo √© auto-explicativo?
- [ ] Testes seguem F.I.R.S.T.?
- [ ] Classes s√£o pequenas (< 200 linhas)?

### Nomenclatura

#### Classes e Interfaces
- ‚úÖ Classes: `PascalCase` (ex: `TerritoryService`, `PostCreationService`)
- ‚úÖ Interfaces: `I` + `PascalCase` (ex: `ITerritoryRepository`, `IMediaStorageService`)
- ‚úÖ DTOs: `PascalCase` + sufixo descritivo (ex: `CreatePostRequest`, `PostResponse`)
- ‚úÖ Entidades: `PascalCase` (ex: `Territory`, `Membership`, `Post`)

#### M√©todos e Propriedades
- ‚úÖ M√©todos: `PascalCase` (ex: `CreatePostAsync`, `GetTerritoryByIdAsync`)
- ‚úÖ Propriedades: `PascalCase` (ex: `Id`, `Title`, `CreatedAtUtc`)
- ‚úÖ Campos privados: `_camelCase` (ex: `_repository`, `_logger`)

#### Vari√°veis e Par√¢metros
- ‚úÖ Vari√°veis locais: `camelCase` (ex: `territoryId`, `userId`)
- ‚úÖ Par√¢metros: `camelCase` (ex: `territoryId`, `cancellationToken`)

### Conven√ß√µes Espec√≠ficas

#### Async/Await
- ‚úÖ Todos os m√©todos ass√≠ncronos terminam com `Async` (ex: `GetTerritoryAsync`)
- ‚úÖ Sempre use `async`/`await` (NUNCA `.Result` ou `.Wait()`)
- ‚úÖ Sempre aceite `CancellationToken` em m√©todos ass√≠ncronos

#### Nullable Reference Types
- ‚úÖ Use `string?` para valores opcionais
- ‚úÖ Use `string` para valores obrigat√≥rios
- ‚úÖ Valide null antes de usar (use `ArgumentNullException.ThrowIfNull`)

#### Result Pattern
- ‚úÖ Use `Result<T>` ou `Result` para opera√ß√µes que podem falhar
- ‚úÖ NUNCA retorne `null` de m√©todos p√∫blicos
- ‚úÖ Use `Option<T>` ou `Maybe<T>` para valores opcionais

### Exemplos de C√≥digo

#### Service Pattern
```csharp
public class TerritoryService : ITerritoryService
{
    private readonly ITerritoryRepository _repository;
    private readonly ILogger<TerritoryService> _logger;

    public TerritoryService(
        ITerritoryRepository repository,
        ILogger<TerritoryService> logger)
    {
        _repository = repository;
        _logger = logger;
    }

    public async Task<Result<Territory>> GetTerritoryByIdAsync(
        Guid territoryId,
        CancellationToken cancellationToken = default)
    {
        ArgumentNullException.ThrowIfNull(territoryId);

        var territory = await _repository.GetByIdAsync(territoryId, cancellationToken);
        if (territory == null)
        {
            return Result<Territory>.NotFound($"Territory {territoryId} not found");
        }

        return Result<Territory>.Success(territory);
    }
}
```

#### Repository Pattern
```csharp
public interface ITerritoryRepository
{
    Task<Territory?> GetByIdAsync(Guid id, CancellationToken cancellationToken);
    Task<IEnumerable<Territory>> FindNearbyAsync(
        double latitude,
        double longitude,
        double radiusKm,
        int limit,
        CancellationToken cancellationToken);
    Task<Territory> AddAsync(Territory territory, CancellationToken cancellationToken);
}
```

---

## üß™ Testes

### Cobertura M√≠nima
- ‚úÖ **Cobertura >90%** obrigat√≥ria
- ‚úÖ Teste todos os casos de erro
- ‚úÖ Teste edge cases
- ‚úÖ Teste valida√ß√µes

### Estrutura de Testes
```
Araponga.Tests/
‚îú‚îÄ‚îÄ Domain/           # Testes de entidades e value objects
‚îú‚îÄ‚îÄ Application/      # Testes de services
‚îú‚îÄ‚îÄ Infrastructure/   # Testes de reposit√≥rios e adapters
‚îî‚îÄ‚îÄ Api/             # Testes de controllers (E2E)
```

### Padr√µes de Teste
- ‚úÖ Use `[Fact]` para testes do xUnit
- ‚úÖ Nomeie testes descritivamente: `MethodName_Scenario_ExpectedBehavior`
- ‚úÖ Use `InMemoryDataStore` para testes isolados
- ‚úÖ Use `WebApplicationFactory<T>` para testes E2E

### Exemplo de Teste
```csharp
[Fact]
public async Task GetTerritoryByIdAsync_WhenTerritoryExists_ReturnsTerritory()
{
    // Arrange
    var territory = new Territory("Test Territory", 0, 0);
    await _repository.AddAsync(territory, CancellationToken.None);

    // Act
    var result = await _service.GetTerritoryByIdAsync(territory.Id, CancellationToken.None);

    // Assert
    Assert.True(result.IsSuccess);
    Assert.Equal(territory.Id, result.Value.Id);
}
```

---

## üìö Documenta√ß√£o - OBRIGAT√ìRIO

### ‚ö†Ô∏è REGRA CR√çTICA: Atualiza√ß√£o Autom√°tica de Documenta√ß√£o

**SEMPRE que voc√™ fizer mudan√ßas no c√≥digo, voc√™ DEVE atualizar a documenta√ß√£o correspondente.**

### Quando Atualizar Documenta√ß√£o

1. **Mudan√ßas em Funcionalidades/Features:**
   - ‚úÖ Atualizar `docs/60_API_L√ìGICA_NEG√ìCIO.md` se mudar l√≥gica de neg√≥cio
   - ‚úÖ Atualizar `docs/22_COHESION_AND_TESTS.md` se implementar nova funcionalidade
   - ‚úÖ Atualizar `docs/03_BACKLOG.md` se completar um epic/feature
   - ‚úÖ Atualizar `docs/40_CHANGELOG.md` com mudan√ßas significativas
   - ‚úÖ Atualizar `README.md` se mudar funcionalidades listadas

2. **Mudan√ßas em Arquitetura:**
   - ‚úÖ Atualizar `docs/10_ARCHITECTURE_DECISIONS.md` se tomar nova decis√£o arquitetural
   - ‚úÖ Atualizar `docs/12_DOMAIN_MODEL.md` se mudar modelo de dom√≠nio
   - ‚úÖ Atualizar `docs/11_ARCHITECTURE_SERVICES.md` se mudar services

3. **Mudan√ßas em APIs/Endpoints:**
   - ‚úÖ Atualizar `docs/60_API_L√ìGICA_NEG√ìCIO.md` com novos endpoints ou mudan√ßas
   - ‚úÖ Atualizar `backend/Araponga.Api/wwwroot/devportal/index.html` se mudar DevPortal
   - ‚úÖ Atualizar exemplos de c√≥digo se mudar contratos

4. **Mudan√ßas em Fases do Backlog:**
   - ‚úÖ Atualizar `docs/backlog-api/FASE*.md` correspondente
   - ‚úÖ Atualizar `docs/backlog-api/README.md` se completar fase
   - ‚úÖ Atualizar `docs/STATUS_FASES.md` se existir
   - ‚úÖ Atualizar `docs/02_ROADMAP.md` se mudar roadmap
   - ‚úÖ Atualizar `docs/backlog-api/implementacoes/FASE*_IMPLEMENTACAO_RESUMO.md` se completar fase

5. **Mudan√ßas em Configura√ß√£o/Seguran√ßa:**
   - ‚úÖ Atualizar `docs/SECURITY_CONFIGURATION.md` se mudar configura√ß√µes
   - ‚úÖ Atualizar `docs/SECURITY_AUDIT.md` se adicionar medidas de seguran√ßa

### Checklist Obrigat√≥rio Antes de Commitar

- [ ] Documenta√ß√£o t√©cnica atualizada (se aplic√°vel)
- [ ] Exemplos de c√≥digo atualizados (se aplic√°vel)
- [ ] Changelog atualizado (se mudan√ßa significativa)
- [ ] README.md atualizado (se mudar funcionalidades principais)
- [ ] Documenta√ß√£o de API atualizada (se mudar endpoints)
- [ ] Documenta√ß√£o de fase atualizada (se completar fase)

### Guia Completo
Consulte `docs/CURSOR_DOCUMENTATION_RULES.md` para mapeamento completo de mudan√ßas ‚Üí documentos.

---

## üîí Seguran√ßa

### Valida√ß√£o de Entrada
- ‚úÖ Sempre valide entrada do usu√°rio
- ‚úÖ Use FluentValidation para DTOs
- ‚úÖ Sanitize strings antes de persistir
- ‚úÖ Valide geolocaliza√ß√£o (lat/lng dentro de ranges v√°lidos)

### Autoriza√ß√£o
- ‚úÖ Sempre verifique permiss√µes antes de opera√ß√µes sens√≠veis
- ‚úÖ Use `[Authorize]` em controllers
- ‚úÖ Verifique membership role (visitor/resident) quando necess√°rio
- ‚úÖ Valide territory ownership quando aplic√°vel

### Dados Sens√≠veis
- ‚úÖ NUNCA logue senhas, tokens ou dados pessoais
- ‚úÖ Use `[Sensitive]` attribute em logs quando necess√°rio
- ‚úÖ Criptografe dados sens√≠veis em repouso

---

## üöÄ Performance

### Queries
- ‚úÖ Use pagina√ß√£o em TODAS as listagens
- ‚úÖ Use `IQueryable` para queries eficientes
- ‚úÖ Evite N+1 queries (use `.Include()` ou proje√ß√µes)
- ‚úÖ Use √≠ndices no banco de dados

### Cache
- ‚úÖ Cache resultados de queries frequentes
- ‚úÖ Invalide cache quando dados mudarem
- ‚úÖ Use `IMemoryCache` ou `IDistributedCache` conforme necess√°rio

### Async
- ‚úÖ Use async/await para opera√ß√µes I/O
- ‚úÖ NUNCA bloqueie threads com `.Result` ou `.Wait()`
- ‚úÖ Configure `ConfigureAwait(false)` em libraries

---

## ‚úÖ Valida√ß√£o Antes de PR - OBRIGAT√ìRIO

### ‚ö†Ô∏è REGRA CR√çTICA: Build e Testes DEVEM Passar

**ANTES de criar qualquer PR, voc√™ DEVE:**

1. **Validar Build:**
   ```bash
   dotnet build --no-restore --configuration Release
   ```
   - ‚úÖ Build DEVE passar sem erros
   - ‚úÖ Apenas warnings aceit√°veis s√£o permitidos
   - ‚ùå NUNCA crie PR com erros de build

2. **Validar Testes:**
   ```bash
   dotnet test --no-build --configuration Release
   ```
   - ‚úÖ TODOS os testes DEVEM passar
   - ‚úÖ Cobertura de testes deve ser mantida (>90%)
   - ‚ùå NUNCA crie PR com testes falhando

3. **Verificar Conflitos de Merge:**
   ```bash
   git fetch origin main
   git merge origin/main
   ```
   - ‚úÖ Resolva TODOS os conflitos antes de criar PR
   - ‚úÖ Teste novamente ap√≥s resolver conflitos
   - ‚ùå NUNCA crie PR com conflitos n√£o resolvidos

### Checklist Obrigat√≥rio Antes de Criar PR

- [ ] **Build passa**: `dotnet build --no-restore --configuration Release` sem erros
- [ ] **Testes passam**: `dotnet test --no-build --configuration Release` todos passando
- [ ] **Sem conflitos**: `git merge origin/main` sem conflitos
- [ ] **Testes ap√≥s merge**: Se houve merge, rodar testes novamente
- [ ] **Documenta√ß√£o atualizada**: Verificar checklist de documenta√ß√£o
- [ ] **C√≥digo revisado**: Verificar se segue padr√µes do projeto

### Se Build ou Testes Falharem

1. **Verifique se os erros s√£o relacionados √†s suas mudan√ßas:**
   - Se SIM: **N√ÉO crie o PR** at√© corrigir
   - Se N√ÉO: Documente no PR que os testes falhando n√£o est√£o relacionados √†s mudan√ßas

2. **Se os erros s√£o relacionados √†s suas mudan√ßas:**
   - **N√ÉO crie o PR**
   - **Corrija os erros localmente**
   - **Valide novamente** (build + testes)
   - **Apenas ent√£o** crie o PR

3. **Se os erros N√ÉO s√£o relacionados √†s suas mudan√ßas:**
   - Documente no PR quais testes est√£o falhando e por que n√£o est√£o relacionados
   - Explique que os testes devem ser corrigidos em um PR separado
   - **Ainda assim, tente corrigir se poss√≠vel** (boa pr√°tica)

### Se Houver Conflitos de Merge

1. **N√ÉO crie o PR**
2. **Fa√ßa merge de `origin/main` na sua branch**
3. **Resolva TODOS os conflitos**
4. **Valide novamente** (build + testes)
5. **Apenas ent√£o** crie o PR

### Comandos de Valida√ß√£o R√°pida

```bash
# Valida√ß√£o completa antes de PR
git fetch origin main
git merge origin/main  # Resolve conflitos se houver
dotnet build --no-restore --configuration Release
dotnet test --no-build --configuration Release
```

**Se qualquer comando falhar, N√ÉO crie o PR at√© corrigir.**

---

## üì¶ Commits e PRs

### Mensagens de Commit
```
feat(module): Descri√ß√£o da funcionalidade

- Implementa [funcionalidade]
- Atualiza documenta√ß√£o em [arquivo(s)]
- Adiciona testes para [cobertura]

Documenta√ß√£o:
- Atualizado docs/60_API_L√ìGICA_NEG√ìCIO.md
- Atualizado docs/40_CHANGELOG.md
```

### Tipos de Commit
- `feat`: Nova funcionalidade
- `fix`: Corre√ß√£o de bug
- `docs`: Mudan√ßa em documenta√ß√£o
- `refactor`: Refatora√ß√£o de c√≥digo
- `test`: Adi√ß√£o ou corre√ß√£o de testes
- `chore`: Tarefas de manuten√ß√£o

### Pull Requests
- ‚úÖ Use o template `.github/pull_request_template.md`
- ‚úÖ Marque checklist de documenta√ß√£o
- ‚úÖ Descreva mudan√ßas claramente
- ‚úÖ Referencie issues relacionadas
- ‚úÖ Garanta que todos os testes passam

---

## üé® Design e UX

### Princ√≠pios de Design
- Territ√≥rio como refer√™ncia
- Baixa excita√ß√£o e foco
- Sil√™ncio funcional com hierarquia clara
- A√ß√£o consciente e expl√≠cita
- Evolu√ß√£o lenta e √≠ntegra

### Regras Cr√≠ticas de Design (OBRIGAT√ìRIO)

#### Cores - NUNCA Hardcoded
- ‚ùå **PROIBIDO**: Cores hex/rgb diretas (`#4dd4a8`, `rgb(77, 212, 168)`)
- ‚ùå **PROIBIDO**: Tailwind arbitr√°rias (`dark:bg-[#4dd4a8]`, `text-[#7dd3ff]`)
- ‚úÖ **OBRIGAT√ìRIO**: Vari√°veis CSS (`var(--accent)`, `var(--link)`)
- ‚úÖ **OBRIGAT√ìRIO**: Classes Tailwind configuradas (`dark:bg-dark-accent`, `dark:text-dark-link`)

#### Mobile-First Obrigat√≥rio
- ‚úÖ Base CSS sem media query (mobile)
- ‚úÖ Ajustes com `@media (min-width: 1024px)` ou `lg:` prefix

#### Vari√°veis CSS Obrigat√≥rias
- ‚úÖ Espa√ßamento: usar `var(--space-8)`, `var(--space-16)`
- ‚úÖ Tipografia: usar `var(--font-size-3xl)`, `var(--line-height-relaxed)`
- ‚úÖ Glass morphism: usar `var(--glass-bg)`, `var(--glass-border)`

### O que √© Bem-vindo
- Legibilidade e redu√ß√£o de ru√≠do
- Consist√™ncia entre telas e estados
- Hierarquia visual clara
- Acessibilidade (contraste WCAG AA, foco, navega√ß√£o por teclado)
- Uso de vari√°veis CSS e tokens de design

### O que Evitar
- Efeitos chamativos e distra√ß√µes
- Satura√ß√£o gratuita
- Anima√ß√µes celebrat√≥rias
- Met√°foras fechadas que reduzam leitura do contexto
- **Cores hardcoded (hex/rgb ou Tailwind arbitr√°rias)** - use vari√°veis CSS ou classes configuradas

---

## üîÑ Processo de Auto-Aprendizado

### ‚ö†Ô∏è OBRIGAT√ìRIO Ap√≥s Revis√µes

**Toda revis√£o t√©cnica DEVE gerar atualiza√ß√£o de diretrizes:**

1. **Capturar Li√ß√µes**: Documentar em `docs/LICOES_APRENDIDAS.md`
   - Identificar padr√µes recurrentes
   - Categorizar (Cr√≠tico/Importante/Otimiza√ß√£o)
   - Documentar contexto e solu√ß√£o

2. **Atualizar Diretrizes**: Aplicar li√ß√µes aprendidas
   - Atualizar `CURSOR_DESIGN_RULES.md` se li√ß√£o √© sobre design
   - Atualizar `.cursorrules` se li√ß√£o √© geral
   - Atualizar outros documentos conforme necess√°rio

3. **Validar**: Garantir efetividade
   - Revisar mudan√ßas
   - Validar conformidade
   - Documentar no changelog

**Processo Completo**: `docs/PROCESSO_AUTO_APRENDIZADO_REVISOES.md`

**Exemplo Pr√°tico**: Ver `docs/LICOES_APRENDIDAS.md` (LIC-001: Cores hardcoded)

---

## üîç Refer√™ncias R√°pidas

### Documenta√ß√£o Principal
- `docs/00_INDEX.md` - √çndice completo
- `docs/01_PRODUCT_VISION.md` - Vis√£o do produto
- `docs/02_ROADMAP.md` - Roadmap
- `docs/10_ARCHITECTURE_DECISIONS.md` - Decis√µes arquiteturais
- `docs/12_DOMAIN_MODEL.md` - Modelo de dom√≠nio
- `docs/60_API_L√ìGICA_NEG√ìCIO.md` - L√≥gica de neg√≥cio e APIs
- `docs/backlog-api/README.md` - Backlog completo (29 fases)

### Gloss√°rio
- `docs/05_GLOSSARY.md` - Termos e conceitos do projeto

### Contribuindo
- `docs/41_CONTRIBUTING.md` - Guia para contribuidores
- `docs/CURSOR_DOCUMENTATION_RULES.md` - Regras de documenta√ß√£o

---

## ‚ö†Ô∏è Lembretes Importantes

1. **Documenta√ß√£o desatualizada √© um bug cr√≠tico**
2. **Territory √© geogr√°fico e neutro - NUNCA coloque l√≥gica social nele**
3. **Sempre use "territory", "items", "29 fases" - nunca alternativas**
4. **Cobertura de testes >90% √© obrigat√≥ria**
5. **Sempre valide entrada e verifique autoriza√ß√£o**
6. **Use pagina√ß√£o em TODAS as listagens**
7. **Commits pequenos e focados s√£o prefer√≠veis**
8. **Ap√≥s revis√µes: OBRIGAT√ìRIO capturar li√ß√µes aprendidas em `LICOES_APRENDIDAS.md` e atualizar diretrizes** (ver `PROCESSO_AUTO_APRENDIZADO_REVISOES.md`)
9. **NUNCA use cores hardcoded** - sempre vari√°veis CSS ou classes Tailwind configuradas
10. **Mobile-first √© obrigat√≥rio** - todo CSS deve come√ßar com mobile, ajustar para desktop
11. **SOLID e YAGNI/KISS s√£o obrigat√≥rios** - todo c√≥digo deve seguir esses princ√≠pios (ver se√ß√£o "Padr√µes de C√≥digo")
12. **Clean Code (Uncle Bob) √© obrigat√≥rio** - nomes significativos, fun√ß√µes pequenas, c√≥digo auto-explicativo (ver se√ß√£o "Padr√µes de C√≥digo")

---

**√öltima Atualiza√ß√£o**: 2025-01-20  
**Vers√£o**: 1.4

### Changelog
- **1.5** (2025-01-20): Adicionados padr√µes de Clean Code (Uncle Bob) como obrigat√≥rios
- **1.4** (2025-01-20): Adicionados princ√≠pios SOLID e YAGNI/KISS como obrigat√≥rios em todo c√≥digo
- **1.3** (2025-01-20): Adicionado processo de auto-aprendizado obrigat√≥rio ap√≥s revis√µes, refor√ßado lembretes de design
- **1.2** (2025-01-20): Adicionadas regras cr√≠ticas de design (cores hardcoded proibidas) ap√≥s revis√£o completa
- **1.1** (2025-01-20): Adicionada se√ß√£o de arquivos de refer√™ncia para contexto
- **1.0** (2025-01-20): Vers√£o inicial
