sequenceDiagram
    participant Cliente
    participant ModerationController
    participant ModerationService
    participant ReportService
    participant WorkQueueService
    participant ModerationCaseService
    participant SanctionRepository
    participant AuditLogger
    participant EventBus
    participant Database

    Cliente->>ModerationController: POST /api/v1/reports (targetType, targetId, reason)
    ModerationController->>ReportService: CreateReportAsync()
    
    ReportService->>Database: INSERT report
    Database-->>ReportService: Report criado
    
    ReportService->>WorkQueueService: EnqueueWorkItem(ModerationCase)
    WorkQueueService->>Database: INSERT work_item
    Database-->>WorkQueueService: WorkItem criado
    
    ReportService->>AuditLogger: LogAsync("report.created")
    ReportService->>EventBus: PublishAsync(ReportCreatedEvent)
    ReportService->>ReportService: CommitAsync()
    ReportService-->>ModerationController: Report
    ModerationController-->>Cliente: 201 Created (report)

    Note over Cliente,Database: Decisão de Moderação (Curator/Moderator)
    Cliente->>ModerationController: POST /api/v1/territories/{territoryId}/work-items/{workItemId}/complete
    ModerationController->>ModerationCaseService: CompleteModerationCaseAsync()
    
    ModerationCaseService->>WorkQueueService: GetWorkItemAsync(workItemId)
    WorkQueueService->>Database: SELECT work_item WHERE id
    Database-->>WorkQueueService: WorkItem
    
    ModerationCaseService->>ReportService: GetByIdAsync(reportId)
    ReportService->>Database: SELECT report WHERE id
    Database-->>ReportService: Report
    
    alt Decisão: Aplicar Sanção
        ModerationCaseService->>SanctionRepository: AddAsync(new Sanction())
        SanctionRepository->>Database: INSERT sanction
        ModerationCaseService->>EventBus: PublishAsync(SanctionAppliedEvent)
    end
    
    ModerationCaseService->>ReportService: UpdateStatusAsync(reportId, Resolved)
    ReportService->>Database: UPDATE report SET status=Resolved
    ModerationCaseService->>WorkQueueService: CompleteWorkItemAsync(workItemId, outcome)
    ModerationCaseService->>AuditLogger: LogAsync("moderation.completed")
    ModerationCaseService->>ModerationCaseService: CommitAsync()
    ModerationCaseService-->>ModerationController: Result.Success
    ModerationController-->>Cliente: 200 OK